<link href="skins/default/category.css" rel="stylesheet" type="text/css" />
<link href="assets/css/kendo/gird/styles/examples-offline.css" rel="stylesheet"/>
<link href="assets/css/kendo/gird/styles/kendo.common.min.css" rel="stylesheet"/>
<link href="assets/css/kendo/gird/styles/kendo.default.min.css" rel="stylesheet"/>
<link href="assets/css/kendo/gird/styles/kendo.dataviz.min.css" rel="stylesheet"/>
<link href="assets/css/kendo/gird/styles/kendo.dataviz.default.min.css" rel="stylesheet"/>
<link href="assets/css/bootstrap/bootstrap.min.css" rel="stylesheet"/>
<link href="assets/css/bootstrap/bootstrap.css" rel="stylesheet"/>

<script src="assets/js/kendo/gird/angular.min.js"></script>
<script src="assets/js/kendo/gird/kendo.all.min.js"></script> 
<script src="assets/js/kendo/gird/jszip.min.js"></script>
<style media="print">
	.search-toolbar{
		display:none;
	}
</style>
<style>
	.item-list-tr td{
		border-top:5px solid #FFFFFF;
	}
    .mouse{   
        cursor: pointer;   
        background-image: url(assets/img/click-16.png); 
        background-repeat: no-repeat;
    }
    .ui-widget input, .ui-widget select, .ui-widget textarea, .ui-widget button{
        font-family: Arial,sans-serif;
        font-size: 1em;
        width: 150px;
    }
    .k-grid td{
        padding-bottom: 0px;
        padding-top: 0px;
    }
    /*css cho header grid*/
    .k-grid-header th.k-header{
        vertical-align: middle;
        text-align: center;
    }
    /*css cho row templateFooter*/
    .k-grid-footer td{
        padding: 0px 0 0 0;                                                       
    }
    .row_templateFooter{
        height: 23px;
        padding-top: 6px;               
        text-align: center;                                              
        border-bottom: 1px solid #c5c5c5;
    }
    .k-button{
        height: 31.59px;
    }
</style>
<link rel="stylesheet" href="skins/default/new-report.css">
<div class="room-type-supplier-bound">
	<div id="header">
        <div class="top">
					<div class="right-top"><span class="logo"><img src="<?php echo HOTEL_LOGO;?>"></span></div>
					<div class="top_aside">
						<h1 class="reporttitle">[[.restaurant_revenue_order.]]</h1>
					      <span class="date"><?php echo Url::get('to_date');?><br />
						</div>
					<div class="wrap">
						<div class="report-left"><label class="top_info">[[.date_print.]] : </label><span class="date_print"><?php echo date('d/m/Y',time());?></span></div>
						
						<div class="report-left"><label class="top_info">[[.time_print.]] : </label><span class="time_print"><?php echo date('H : i',time());?></span></div>
						
						<div class="report-left"><label class="top_info">[[.user_print.]] : </label><span class="p_print"><?php echo Session::get('user_id');?></span></div>
						
						<div class="report-left"><label class="top_info">[[.depart.]] : </label><span>[[|department_name|]]</span></div>
					</div>	
		</div><!--end .top-->
    </div>
	<div class="content"><br />
    <!--============Dua dieu kien tim kiem vao day=============== -->
    
	
    <form name="SearchForm" method="post">
        	<fieldset class="search-toolbar">                        
            
            <table border="0" cellspacing="0" cellpadding="2">
              	<tr>
                    <!--
<td> <input id="location_id" value="1" style="width: 150px;" /></td>
--> 
                    <td> <select name="location_id" id="location_id"></select></td>
                    <td>[[.from_date.]] 
                       <input name="from_date" type="text" id="from_date" style="width:70px;" autocomplete="OFF" />
                       <input name="from_hour" type="text" id="from_hour" style="width:45px;" autocomplete="OFF" />
                    </td>
                    <td>[[.to_date.]] <input name="to_date" type="text" id="to_date" style="width:70px;" autocomplete="OFF" />
                       <input name="to_hour" type="text" id="to_hour" style="width:45px;"  autocomplete="OFF" /></td>
                    <td><input type="submit"  class="k-button k-primary" name="do_search" value="  [[.report.]]  "/></td>
                    <td><button id="export" class="k-button"><span class="k-icon k-i-excel"></span>Export to Excel</button></td>
                </tr>
            </table>
            
            </fieldset>
    </form>	
    <!--============== ket thuc dieu kien tim kiem===================-->
        
        
        <!-- Phan noi dung ket qua sau tim kiem dua vao day -->
        <!---------REPORT----------->
        <!--du lieu moi-->
        <table cellpadding="5" cellspacing="5" width="100%" border="1" bordercolor="#CCCCCC" class="table-bound">
        	<tr valign="middle" bgcolor="#EFEFEF">
              <th width="8%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.CODE.]]</th>
        	  <th width="5%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.commodity_returns.]]</th>
              <th width="3%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.SN.]]</th>
              <th width="5%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.number_table.]]</th>
              <th width="7%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.into_money.]]</th>
              <th width="5%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.discount.]]</th>
              <th width="5%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.service.]]</th>
              <th width="5%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.discount_vip.]]</th>
              <th width="5%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.vat.]]</th>
              <th width="8%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.total.]]</th>
              <th width="40" colspan="7" scope="colgroup" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.part_payments.]]</th>
              <th width="4%" rowspan="2" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.status.]]</th>
            </tr>
            <tr>
              <th  width="7%" scope="colgroup" style="text-align: center;font-weight:bold;" class="report-table-header">[[.VND.]]</th>
              <th  width="5%" scope="colgroup" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.USD.]]</th>
              <th  width="7%" scope="colgroup" style="text-align: center;font-weight:bold;" class="report-table-header">[[.eat.]]</th>
              <th  width="6%" scope="colgroup" style="text-align: center;font-weight:bold;" class="report-table-header">[[.drink.]]</th>
              <th  width="5%" scope="colgroup" style="text-align: center;font-weight:bold;" class="report-table-header" >[[.tiep_khach.]]</th>
              <th  width="5%" scope="colgroup" style="text-align: center;font-weight:bold;" class="report-table-header">[[.voucher.]]</th>
              <th  width="5%" scope="colgroup" style="text-align: center;font-weight:bold;" class="report-table-header">[[.owe.]]</th>
            </tr>
            <?php
                $num_people_t = 0;
                $table_t = 0;
                $total_root_t = 0;
                $discnt_t = 0;
                $bar_fee_t = 0;
                $discount_money_vip_t = 0;
                $tax_t = 0;
                $total_t = 0;
                $vnd_t = 0;
                $usd_t = 0;
                $eat_t = 0;
                $drink_t = 0;
                $tiep_khach_t = 0;
                $voucher_t = 0;
                $kn_t = 0;
            ?>
          <!--LIST:items-->
          <tr>
                <td  style="text-align:left;">[[|items.code|]]</td>
                <td  style="text-align:left;"></td>
                <td  style="text-align:right;">[[|items.num_people|]]</td>
                <td  style="text-align:left; word-break: keep-all;"><?php echo [[=items.table_name=]];?></td>
                <td  style="text-align:right;"><?php if([[=items.total_root=]]!=0) echo number_format([[=items.total_root=]]);?></td>
                <td  style="text-align:right;"><?php if([[=items.discnt=]]!=0) echo number_format([[=items.discnt=]]);?></td>
                <td  style="text-align:right;"><?php if([[=items.bar_fee=]]!=0)  echo number_format([[=items.bar_fee=]]);?></td>
                <td  style="text-align:right;"><?php  if([[=items.discount_money_vip=]]!=0) echo number_format([[=items.discount_money_vip=]]);?></td>
                <td  style="text-align:right;"><?php if([[=items.tax=]]!=0)  echo number_format([[=items.tax=]]);?></td>
                <td  style="text-align:right;"><?php if([[=items.total=]]!=0)  echo number_format([[=items.total=]]);?></td>
                <td  style="text-align:right;"><?php if([[=items.vnd=]]!=0) echo number_format([[=items.vnd=]]);?></td>
                <td  style="text-align:right;"></td>
                <td  style="text-align:right;"><?php if([[=items.eat=]]!=0)  echo number_format([[=items.eat=]]);?></td>
                <td  style="text-align:right;"><?php  if([[=items.drink=]]!=0) echo number_format([[=items.drink=]]);?></td>
                <td  style="text-align:right;"></td>
                <td  style="text-align:right;"></td>
                <td  style="text-align:right;"><?php if([[=items.status=]]!='CHECKIN'){$kn_t += [[=items.debt=]]; if([[=items.debt=]]!=0) echo number_format([[=items.debt=]]);}?></td>
                <td  style="text-align:left;"><?php if([[=items.status=]]=='CHECKIN'){?>[[.check_in.]]<?php } else if([[=items.debt=]]==0){?>[[.already_paid.]]<?php ;}else{ ?>[[.not_yet.]]<?php ;}?></td>
          </tr>
          <?php
                $num_people_t += [[=items.num_people=]];
                $table_t += 1;
                $total_root_t += [[=items.total_root=]];
                $discnt_t += [[=items.discnt=]];
                $bar_fee_t += [[=items.bar_fee=]];
                $discount_money_vip_t += [[=items.discount_money_vip=]];
                $tax_t += [[=items.tax=]];
                $total_t += [[=items.total=]];
                $vnd_t += [[=items.vnd=]];
                $usd_t += 0;
                $eat_t += [[=items.eat=]];
                $drink_t += [[=items.drink=]];
                $tiep_khach_t += 0;
                $voucher_t += 0;
                
          ?>
          <!--/LIST:items-->
          <tr style="background-color:#e6e6eF;">
                <td style="text-align: left; font-weight: bold;" >[[.part_total.]]:</td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: right;"></td><td style="text-align: left;" ></td>
          </tr>
          
          <tr style="background-color:#e6e6eF;">
                <td style="text-align: left;font-weight: bold;" >[[.total_bill.]]:</td>
                <td style="text-align: right;"></td>
                <td style="text-align: right;"><?php if($num_people_t!=0) echo number_format($num_people_t); ?></td>
                <td style="text-align: right;"><?php if($table_t!=0) echo number_format($table_t); ?></td>
                <td style="text-align: right;"><?php if($total_root_t!=0) echo number_format($total_root_t); ?></td>
                <td style="text-align: right;"><?php if($discnt_t!=0) echo number_format($discnt_t); ?></td>
                <td style="text-align: right;"><?php if($bar_fee_t!=0) echo number_format($bar_fee_t); ?></td>
                <td style="text-align: right;"><?php if($discount_money_vip_t!=0) echo number_format($discount_money_vip_t); ?></td>
                <td style="text-align: right;"><?php if($tax_t!=0) echo number_format($tax_t); ?></td>
                <td style="text-align: right;"><?php if($total_t!=0) echo number_format($total_t); ?></td>
                <td style="text-align: right;"><?php if($vnd_t!=0) echo number_format($vnd_t);?></td>
                <td style="text-align: right;"><?php if($usd_t!=0) echo number_format($usd_t); ?></td>
                <td style="text-align: right;"><?php if($eat_t!=0) echo number_format($eat_t); ?></td>
                <td style="text-align: right;"><?php if($drink_t!=0) echo number_format($drink_t); ?></td>
                <td style="text-align: right;"><?php if($tiep_khach_t!=0) echo number_format($tiep_khach_t); ?></td>
                <td style="text-align: right;"><?php if($voucher_t!=0) echo number_format($voucher_t); ?></td>
                <td style="text-align: right;"><?php if($kn_t!=0) echo number_format($kn_t); ?></td>
                <td style="text-align: left;" ></td>
          </tr>
          <tr style="background-color:#e6e6eF;">
                <td style="text-align: left;font-weight: bold;" >[[.cancel.]]:</td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: right;"><?php ?></td>
                <td style="text-align: left;" ></td>
          </tr>
          <tr style="background-color:#e6e6eF;">
                <td style="text-align: left;font-weight: bold;" >[[.actual_revenues.]]:</td>
                <td style="text-align: right;"></td>
                <td style="text-align: right;"><?php if($num_people_t!=0) echo number_format($num_people_t); ?></td>
                <td style="text-align: right;"><?php if($table_t!=0) echo number_format($table_t); ?></td>
                <td style="text-align: right;"><?php if($total_root_t!=0) echo number_format($total_root_t); ?></td>
                <td style="text-align: right;"><?php if($discnt_t!=0) echo number_format($discnt_t); ?></td>
                <td style="text-align: right;"><?php if($bar_fee_t!=0) echo number_format($bar_fee_t); ?></td>
                <td style="text-align: right;"><?php if($discount_money_vip_t!=0) echo number_format($discount_money_vip_t); ?></td>
                <td style="text-align: right;"><?php if($tax_t!=0) echo number_format($tax_t); ?></td>
                <td style="text-align: right;"><?php if($total_t!=0) echo number_format($total_t); ?></td>
                <td style="text-align: right;"><?php if($vnd_t!=0) echo number_format($vnd_t);?></td>
                <td style="text-align: right;"><?php if($usd_t!=0) echo number_format($usd_t); ?></td>
                <td style="text-align: right;"><?php if($eat_t!=0) echo number_format($eat_t); ?></td>
                <td style="text-align: right;"><?php if($drink_t!=0) echo number_format($drink_t); ?></td>
                <td style="text-align: right;"><?php if($tiep_khach_t!=0) echo number_format($tiep_khach_t); ?></td>
                <td style="text-align: right;"><?php if($voucher_t!=0) echo number_format($voucher_t); ?></td>
                <td style="text-align: right;"><?php if($kn_t!=0) echo number_format($kn_t); ?></td>
                <td style="text-align: left;" ></td>
          </tr>
        </table>  
         <!--du lieu cu-->
        <!-- Ket thuc phan noi dung tim kiem-->    
	
		<br />
	</div>
	<input name="cmd" type="hidden" value="">
    </div>
    <div id="grid" style="display: none;"></div>
    <!--
<div id="grid" style="display: none;"></div>
-->
    <!--ThÃ´ng tin chá»¯ kÃ½ cá»§a bÃ¡o cÃ¡o Ä‘Æ°a vÃ o Ä‘ay -->
    <table width="100%">
    <tr>
    	<td></td>
    	<td></td>
    	<td align="center">[[.day.]] <?php echo date('d');?>[[.month.]] <?php echo date('m');?> [[.year.]] <?php echo date('Y');?><br /></td>
    </tr>
    <tr valign="top">
    	<td width="33%" align="center">[[.creator.]]</td>
    	<td width="33%" align="center">[[.general_accountant.]]</td>
    	<td width="33%" align="center">[[.director.]]</td>
    </tr>
    </table>
    <!--Ket thÃºc pháº§n thÃ´ng tin chá»¯ kÃ½--> 
</div>
               
        <script>
                //jQuery(document).ready(function() {
//                    var data = [
//                        { id: 1, name: 'ST + SN + DS' },
//                        { id: 2, name: 'Láº§u 1 + VIP' }                        
//                    ];
//
//                    // create DropDownList from input HTML element
//                    jQuery("#location_id").kendoDropDownList({
//                        optionLabel: "Select location...",
//                        dataTextField: "name",
//                        dataValueField: "id",
//                        dataSource: data,
//                        index: 0,
//                        dataBound: function(){
//
//                        e.model.location_id.id = this.dataItem().id;
//                        e.model.location_id.name = this.dataItem().name;
//                        console.log('data item:');
//                        console.log(this.dataItem());
//    
//                        }
//                    });
//                                        
//                   
//                    
//                    var color = jQuery("#location_id").data("kendoDropDownList");
//
//                    location_id.select(0);
//                    
//                    
//                });

                // used to sync the exports
                var promises = [
                jQuery.Deferred()
                ];
                jQuery("#export").click(function(e){
                ////trigger export of the report grid
//                jQuery("#grid").data("kendoGrid").saveAsExcel();
//                                               
//                jQuery.when.apply(null, promises)
//                .then(function(report) {
//                
//                //create a new workbook using the sheets of the report
//                var sheets = [
//                report.sheets[0],                
//                ];
//                
//                sheets[0].title = "BaoCaoDoanhThu"; 
//                var workbook = new kendo.ooxml.Workbook({
//                sheets: sheets                                               
//                });  
                
            var ds = new kendo.data.DataSource({
            type: "json",
            transport: {
                    read: {
                        url: "/?page=restaurant_revenue_order&cmd=loaddata&from_date=<?php echo [[=from_date=]];?>&to_date=<?php echo [[=to_date=]];?>&from_hour=<?php echo [[=from_hour=]];?>&to_hour=<?php echo [[=to_hour=]];?>&location_id=<?php echo [[=location_id=]];?>",                        
                        dataType: "json"
                    }                               
            },
            schema: {
                  model: {
                    fields: {
                        code: { type: "string" },            
                        num_people: { type: "number" },
                        table_name: { type: "string" },
                        total_root: { type: "number" },
                        discnt: { type: "number" },
                        bar_fee: { type: "number" },
                        discount_money_vip: { type: "number" },
                        tax: { type: "number" },
                        total: { type: "number" },
                        vnd: { type: "number" },
                        eat: { type: "number" },
                        drink: { type: "number" },
                        debit: { type: "number" }, 
                        status: { type: "string" },                   
                    }
                  }
                }
            });
            var rows=[{
                cells:[
                    { value: "",colSpan: 10},
                    { value: "[[.part_payments.]]", colSpan: 7},
                    { value: ""},
                ]
            }];
            rows.push({
                    cells: [                       
                        { value: "[[.CODE.]]"},
                        { value: "[[.commodity_returns.]]"},
                        { value: "[[.SN.]]"}, 
                        { value: "[[.number_table.]]"}, 
                        { value: "[[.into_money.]]"},
                        { value: "[[.discount.]]"},
                        { value: "[[.service.]]"},
                        { value: "[[.discount_vip.]]"},
                        { value: "[[.vat.]]"},
                        { value: "[[.total.]]"},                        
                        { value: "[[.VND.]]" },
                        { value: "[[.USD.]]" },
                        { value: "[[.eat.]]" },
                        { value: "[[.drink.]]" },
                        { value: "[[.tiep_khach.]]" }, 
                        { value: "[[.voucher.]]" },
                        { value: "[[.owe.]]" },
                        { value: "[[.status.]]"}, 
                    ]
                    })
            
            //using fetch, so we can process the data when the request is successfully completed
            ds.fetch(function(){
                var data = this.data();
                for (var i = 0; i < data.length; i++){
                    //push single row for every record
                    var status1 ="";
                    if(data[i].status=='CHECKIN'){
                        status1 = "[[.check_in.]]";
                    }else if(data[i].status=='CHECKOUT'){
                        if(data[i].debit==0){
                            status1= "[[.already_paid.]]";
                        }else if(data[i].debit>0){
                            status1= "[[.not_yet.]]";
                        }  
                    }else 
                        var status1 ="";                                                                              
                    rows.push({
                    cells: [
                        { value: data[i].code },
                        { value: ""},
                        { value: data[i].num_people },
                        { value: data[i].table_name },
                        { value: data[i].total_root },
                        { value: data[i].discnt },
                        { value: data[i].bar_fee },
                        { value: data[i].discount_money_vip },
                        { value: data[i].tax },
                        { value: data[i].total },
                        { value: data[i].vnd },
                        { value: ""},
                        { value: data[i].eat },
                        { value: data[i].drink },
                        { value: ""},
                        { value: ""},
                        { value: data[i].debit },
                        { value: status1 },
                    ]
                    }) 
                }
            for(var i =0;i<2;i++){
                var row = rows[i];
                for (var cellIndex = 0; cellIndex < row.cells.length; cellIndex ++) {
                row.cells[cellIndex].background = "#aabbcc";
                row.cells[cellIndex].color = "#0000ff"; 
                row.cells[cellIndex].bold = true;               
              }
            }
            rows[0].cells[1].background = "#ffff00";
            for(var i = rows.length-3;i<rows.length;i++){
                var row = rows[i];
                for (var cellIndex = 0; cellIndex < row.cells.length; cellIndex ++) {
                row.cells[cellIndex].background = "#aabbcc";
                row.cells[cellIndex].bold = true;                               
              }
            }   
            var workbook = new kendo.ooxml.Workbook({
              sheets: [
                {
                  columns: [
                    // Column settings (width)
                    { width: 150 },
                    { width: 100 },
                    { width: 50 },
                    { width: 150 },
                    { width: 150 },
                    { width: 150 },
                    { width: 150 },
                    { width: 150 },
                    { width: 150 },
                    { width: 150 },
                    { width: 150 },
                    { width: 30 },
                    { width: 150 },
                    { width: 150 },
                    { width: 50 },
                    { width: 50 },
                    { width: 150 },
                    { width: 150 },
                  ],
                  // Title of the sheet
                  title: "BaoCaoDoanhThu",
                  // Rows of the sheet
                  rows: rows
                }
              ]
            });                                 
            //save the new workbook,b
            kendo.saveAs({
            dataURI: workbook.toDataURL(),
            fileName: "BaoCaoDoanhThu.xlsx"
            })
        });
});                
</script>

<script>
jQuery(document).ready(function() {   
    var dataSource = new kendo.data.DataSource({
                            transport: {
                                read: {
                                    url: "/?page=restaurant_revenue_order&cmd=loaddata&from_date=<?php echo [[=from_date=]];?>&to_date=<?php echo [[=to_date=]];?>&from_hour=<?php echo [[=from_hour=]];?>&to_hour=<?php echo [[=to_hour=]];?>&location_id=<?php echo [[=location_id=]];?>",
                                    dataType: "json"
                                },                                                             
                                parameterMap: function (options, operation) {
                                    if (operation !== "read" && options.models) {
                                        return { models: kendo.stringify(options.models) };
                                    }
                                }                                
                            },                            
                            batch: true,
                            pageSize: 2,    
                            schema: { model: 
                                    { id: "id",
                                        fields: {
                                            id: { editable: false, nullable: true },                                                                                                                                                           
                                            code: {type: "string"},
                                            payment_result: { type: "string" },                                                                                                                                
                                    }
                                }
                            },
                            aggregate: [
                                          { field: "num_people", aggregate: "sum" },
                                          { field: "table_name", aggregate: "count" },
                                          { field: "total_root", aggregate: "sum"},
                                          { field: "discnt", aggregate: "sum"},
                                          { field: "bar_fee", aggregate: "sum"},
                                          { field: "discount_money_vip", aggregate: "sum"},   
                                          { field: "tax", aggregate: "sum"},
                                          { field: "total", aggregate: "sum"},                                          
                                          { field: "vnd", aggregate: "sum"},
                                          { field: "eat", aggregate: "sum"},
                                          { field: "drink", aggregate: "sum"}, 
                                          { field: "debit", aggregate: "sum"},                                      
                                          ],
                  });
               console.log(dataSource);   
        jQuery("#grid").kendoGrid({   
        dataSource: dataSource,
        batch: true,       
        scrollable: true,        
        height: 500,    
        groupable: false,  
        allowCopy: false,
        pageable: true,
        resizable: true,
        reorderable: false,
        //toolbar: ["excel"],
//        excel: {
//            fileName: "BaoCaoDoanhThu.xlsx",
//            proxyURL: "//demos.telerik.com/kendo-ui/service/export",
//            filterable: true
//        },
        excelExport: function(e) {            
            //e.preventDefault();            
//            allPages: true;
//            promises[0].resolve(e.workbook);
            var sheet = e.workbook.sheets[0];
          for (var rowIndex = 1; rowIndex < sheet.rows.length; rowIndex++) {
            var row = sheet.rows[rowIndex];
            //for (var cellIndex = 0; cellIndex < row.cells.length; cellIndex ++) {
//              row.cells[cellIndex].format = "[Blue]#,##0.0_);[Red](#,##0.0);0.0;"
//            }
          }                
        },
                                
        columns: [            
                    {
                        field: "code",
                        title: "[[.CODE.]]" ,
                        attributes: {"style": "text-align: left; margin: 10px;"},
                        width: 60,                        
                        footerTemplate: "<div class='row_templateFooter'>[[.total_bill.]]:</div><div class='row_templateFooter'>[[.cancel.]]:</div><div class='row_templateFooter'>[[.actual_revenues.]]:</div>",                        
                    },
                    {
                        field: "commodity_returns",
                        title: "[[.commodity_returns.]]",
                        attributes: {"style": "text-align: right"},
                        width: 35,
                        footerTemplate: "<div class='row_templateFooter'></div><div class='row_templateFooter'></div><div class='row_templateFooter'></div>",                                           
                    },
                    {
                        field: "num_people",
                        title: "[[.SN.]]",
                        attributes: {"style": "text-align: right"},
                        width: 20,                                                
                        aggregates: ["sum","sum"],
                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",                                                                 
                    },
                    {
                        field: "table_name",
                        title: "[[.number_table.]]",
                        attributes: {"style": "text-align: left"},
                        width: 35, 
                        aggregates: ["count","count"],
                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(count, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(count, 'n0')#</div>",                                         
                    },
                    {
                        field: "total_root",
                        title: "[[.into_money.]]",
                        attributes: {"style": "text-align: right"},
                        width: 60,
                        format: '{0:n0}', 
                        aggregates: ["sum","sum"],
                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",
                    },
                    {
                        field: "discnt",
                        title: "[[.discount.]]",
                        attributes: {"style": "text-align: right"},
                        width: 35,
                        format: '{0:n0}', 
                        aggregates: ["sum","sum"],
                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",                                           
                    },
                    {
                        field: "bar_fee",
                        title: "[[.service.]]",
                        attributes: {"style": "text-align: right"},
                        width: 35, 
                        format: '{0:n0}', 
                        aggregates: ["sum","sum"],
                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",                                          
                    },
                    {
                        field: "discount_money_vip",
                        title: "[[.discount_vip.]]",
                        attributes: {"style": "text-align: right"},
                        width: 40,
                        format: '{0:n0}', 
                        aggregates: ["sum","sum"],
                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",                                          
                    },
                    {
                        field: "tax",
                        title: "[[.vat.]]",
                        attributes: {"style": "text-align: right"},
                        width: 30,
                        format: '{0:n0}', 
                        aggregates: ["sum","sum"],
                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",                                           
                    },
                    {
                        field: "total",
                        title: "[[.total.]]",
                        attributes: {"style": "text-align: right"},
                        width: 40,
                        format: '{0:n0}', 
                        aggregates: ["sum","sum"],
                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",                                                                   
                    },                    
                    {
                        title:"[[.part_payments.]]",
                        columns: [
                                    {
                                        field: "vnd",
                                        title: "[[.VND.]]" ,
                                        attributes: {"style": "text-align: right; margin: 10px;"},
                                        width: 40,
                                        format: '{0:n0}', 
                                        aggregates: ["sum","sum"],
                                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",
                                    },
                                    {
                                        field: "usd",
                                        title: "[[.USD.]]" ,
                                        attributes: {"style": "text-align: right; margin: 10px;"},
                                        width: 25,
                                        footerTemplate: "<div class='row_templateFooter'></div><div class='row_templateFooter'></div><div class='row_templateFooter'></div>",
                                    },                        
                                    {
                                        field: "eat",
                                        title: "[[.eat.]]" ,
                                        attributes: {"style": "text-align: right; margin: 10px;"},
                                        width: 40,
                                        format: '{0:n0}', 
                                        aggregates: ["sum","sum"],
                                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",
                                    },
                                    {
                                        field: "drink",
                                        title: "[[.drink.]]" ,
                                        attributes: {"style": "text-align: right; margin: 10px;"},
                                        width: 40,
                                        format: '{0:n0}', 
                                        aggregates: ["sum","sum"],
                                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",
                                    },
                                    {
                                        field: "tiep_khach",
                                        title: "[[.tiep_khach.]]" ,
                                        attributes: {"style": "text-align: right; margin: 10px;"},
                                        width: 40,
                                        footerTemplate: "<div class='row_templateFooter'></div><div class='row_templateFooter'></div><div class='row_templateFooter'></div>",
                                    },
                                    {
                                        field: "voucher",
                                        title: "[[.voucher.]]" ,
                                        attributes: {"style": "text-align: right; margin: 10px;"},
                                        width: 35,
                                        footerTemplate: "<div class='row_templateFooter'></div><div class='row_templateFooter'></div><div class='row_templateFooter'></div>",
                                    },
                                    {
                                        field: "debit",
                                        title: "[[.owe.]]" ,
                                        attributes: {"style": "text-align: right; margin: 10px;"},
                                        width: 40,
                                        format: '{0:n0}',
                                        aggregates: ["sum"],
                                        footerTemplate: "#= kendo.toString(sum, 'n0')#"
                                        //aggregates: ["sum","sum"],
//                                        footerTemplate: "<div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div><div class='row_templateFooter'></div><div class='row_templateFooter'>#= kendo.toString(sum, 'n0')#</div>",
                                    },
                                    
                        ]
                        
                    },
                    {
                        field: "status",
                        title: "[[.status.]]",
                        attributes: {"style": "text-align: left"},
                        width: 45,                                           
                    },
                ]                                         
        });                                                                        
});

</script>
            	
<script type="text/javascript">
	jQuery("#from_date").datepicker();
	jQuery("#to_date").datepicker();
    jQuery("#from_hour").timepicker();
    jQuery("#to_hour").timepicker();
</script>            